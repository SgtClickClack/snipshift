(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454,553],{2150:function(e,t,r){Promise.resolve().then(r.bind(r,7485))},7485:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return RegisterPage}});var n=r(7573),s=r(9585),o=r(9183),a=r(6126),i=r(2859),l=r(6254),c=r(8740),u=r(6718),d=r(3648),m=r(8434),h=r(4287),f=r(3075),p=r(1589),g=r(4656),y=r(2641),v=r(4070),x=r(4053),b=r(8790),P=r(1553),w=r(2851),j=r(6246),C=r(1135);function RegisterPage(){var e;let t=(0,i.useSearchParams)(),r=(0,i.useRouter)(),{showNotification:A}=(0,w.l)(),{dispatch:D}=(0,j.a)(),[S,N]=(0,s.useState)({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",role:(null===(e=t.get("role"))||void 0===e?void 0:e.toUpperCase())||"PROFESSIONAL"}),[_,I]=(0,s.useState)({}),[E,R]=(0,s.useState)({status:"testing",message:"Testing API connectivity..."});(0,s.useEffect)(()=>{let testConnection=async()=>{console.log("\uD83D\uDE80 Starting API connectivity test...");try{let t=await (0,C.M)();if(t.success)R({status:"success",message:"API connection successful! Ready for registration."}),console.log("✅ API connectivity test completed successfully");else{var e;R({status:"failed",message:"API connection failed: ".concat((null===(e=t.error)||void 0===e?void 0:e.message)||"Unknown error")}),console.error("❌ API connectivity test failed:",t.error)}}catch(e){R({status:"failed",message:"API connection error: ".concat(e instanceof Error?e.message:"Unknown error")}),console.error("\uD83D\uDCA5 API connectivity test crashed:",e)}};testConnection()},[]);let{data:Z,loading:O,error:T}=(0,o.aM)(P.GET_USER_ROLES,{onCompleted:e=>{console.log("\uD83D\uDCCB User roles fetched successfully:",e)},onError:e=>{console.error("❌ Failed to fetch user roles:",e)}}),[k,{loading:U}]=(0,a.D)(P.c7,{onCompleted:e=>{if(console.log("\uD83C\uDF89 Registration mutation completed:",e),e.register.success){let{user:t,token:n}=e.register;localStorage.setItem("authToken",n),localStorage.setItem("userData",JSON.stringify(t)),D({type:"SET_AUTH",payload:{user:t,token:n}}),console.log("✅ Registration successful! User data:",t),console.log("\uD83D\uDD11 JWT Token received:",n.substring(0,20)+"..."),A("Registration successful! Welcome to SnipShift!","success"),r.push("/dashboard")}else console.error("❌ Registration failed:",e.register.message),A(e.register.message||"Registration failed","error")},onError:e=>{console.error("\uD83D\uDCA5 Registration mutation error:",e),A("Registration error: ".concat(e.message),"error")}}),validateForm=()=>{let e={};return S.email&&/\S+@\S+\.\S+/.test(S.email)||(e.email="Valid email is required"),(!S.password||S.password.length<6)&&(e.password="Password must be at least 6 characters"),S.password!==S.confirmPassword&&(e.confirmPassword="Passwords do not match"),S.firstName.trim()||(e.firstName="First name is required"),S.lastName.trim()||(e.lastName="Last name is required"),I(e),0===Object.keys(e).length},handleSubmit=async e=>{if(e.preventDefault(),console.log("\uD83D\uDCDD Form submitted with data:",{...S,password:"***",confirmPassword:"***"}),!validateForm()){console.warn("⚠️ Form validation failed");return}if("success"!==E.status){A("API connection not available. Please try again.","error");return}console.log("\uD83D\uDE80 Sending registration mutation to API...");try{await k({variables:{input:{email:S.email,password:S.password,displayName:"".concat(S.firstName," ").concat(S.lastName),roles:[S.role],currentRole:S.role}}})}catch(e){console.error("\uD83D\uDCA5 Registration submission failed:",e)}},handleInputChange=e=>t=>{let r=t.target.value;N(t=>({...t,[e]:r})),_[e]&&I(t=>({...t,[e]:void 0}))};return(0,n.jsx)(l.Z,{maxWidth:"sm",sx:{py:8},children:(0,n.jsxs)(c.Z,{elevation:3,sx:{p:4},children:[(0,n.jsx)(u.Z,{variant:"h4",component:"h1",gutterBottom:!0,align:"center",children:"Join SnipShift 2.0"}),(0,n.jsx)(u.Z,{variant:"body1",color:"text.secondary",align:"center",sx:{mb:3},children:"Create your account and connect with the creative industry"}),(0,n.jsx)(d.Z,{sx:{mb:3},children:(0,n.jsx)(m.Z,{severity:"success"===E.status?"success":"failed"===E.status?"error":"info",icon:"testing"===E.status?(0,n.jsx)(h.Z,{size:20}):void 0,children:E.message})}),O&&(0,n.jsx)(m.Z,{severity:"info",sx:{mb:2},children:"Loading user roles from API..."}),T&&(0,n.jsxs)(m.Z,{severity:"warning",sx:{mb:2},children:["Failed to load roles: ",T.message]}),Z&&(0,n.jsx)(m.Z,{severity:"success",sx:{mb:2},children:"✅ Roles loaded successfully from API!"}),(0,n.jsxs)(d.Z,{component:"form",onSubmit:handleSubmit,sx:{mt:2},children:[(0,n.jsxs)(d.Z,{sx:{display:"flex",gap:2,mb:2},children:[(0,n.jsx)(f.Z,{fullWidth:!0,label:"First Name",value:S.firstName,onChange:handleInputChange("firstName"),error:!!_.firstName,helperText:_.firstName,required:!0}),(0,n.jsx)(f.Z,{fullWidth:!0,label:"Last Name",value:S.lastName,onChange:handleInputChange("lastName"),error:!!_.lastName,helperText:_.lastName,required:!0})]}),(0,n.jsx)(f.Z,{fullWidth:!0,label:"Email",type:"email",value:S.email,onChange:handleInputChange("email"),error:!!_.email,helperText:_.email,sx:{mb:2},required:!0}),(0,n.jsxs)(p.Z,{fullWidth:!0,sx:{mb:2},children:[(0,n.jsx)(g.Z,{children:"Role"}),(0,n.jsxs)(y.Z,{value:S.role,label:"Role",onChange:handleInputChange("role"),children:[(0,n.jsx)(v.Z,{value:"HUB",children:"Hub Owner"}),(0,n.jsx)(v.Z,{value:"PROFESSIONAL",children:"Professional"}),(0,n.jsx)(v.Z,{value:"BRAND",children:"Brand"}),(0,n.jsx)(v.Z,{value:"TRAINER",children:"Trainer"})]})]}),(0,n.jsx)(f.Z,{fullWidth:!0,label:"Password",type:"password",value:S.password,onChange:handleInputChange("password"),error:!!_.password,helperText:_.password,sx:{mb:2},required:!0}),(0,n.jsx)(f.Z,{fullWidth:!0,label:"Confirm Password",type:"password",value:S.confirmPassword,onChange:handleInputChange("confirmPassword"),error:!!_.confirmPassword,helperText:_.confirmPassword,sx:{mb:3},required:!0}),(0,n.jsxs)(d.Z,{sx:{mb:2},children:[(0,n.jsx)(x.Z,{label:"Test: testuser@dojopool.com",variant:"outlined",color:"info",onClick:()=>{N(e=>({...e,email:"testuser@dojopool.com"}))},sx:{mr:1,mb:1}}),(0,n.jsx)(x.Z,{label:"Password: test123",variant:"outlined",color:"info",onClick:()=>{N(e=>({...e,password:"test123",confirmPassword:"test123"}))}})]}),(0,n.jsx)(b.Z,{type:"submit",fullWidth:!0,variant:"contained",size:"large",disabled:U||"success"!==E.status,sx:{py:1.5},children:U?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.Z,{size:20,sx:{mr:1}}),"Creating Account..."]}):"Create Account"})]}),(0,n.jsxs)(u.Z,{variant:"body2",align:"center",sx:{mt:3},children:["Already have an account?"," ",(0,n.jsx)(b.Z,{variant:"text",onClick:()=>r.push("/auth/login"),children:"Sign In"})]})]})})}},1135:function(e,t,r){"use strict";r.d(t,{M:function(){return testApiConnectivity},l:function(){return m}});var n=r(5943),s=r(4859),o=r(3859),a=r(2738),i=r(6746),l=r(6952);let c=(0,n.L)({uri:"/graphql"}),u=(0,i.v)((e,t)=>{let{headers:r}=t,n=localStorage.getItem("authToken");return{headers:{...r,authorization:n?"Bearer ".concat(n):""}}}),d=(0,l.q)(e=>{let{graphQLErrors:t,networkError:r,operation:n,forward:s}=e;t&&t.forEach(e=>{let{message:t,locations:r,path:n}=e;console.log("[GraphQL error]: Message: ".concat(t,", Location: ").concat(r,", Path: ").concat(n))}),r&&(console.log("[Network error]: ".concat(r)),"statusCode"in r&&401===r.statusCode&&(localStorage.removeItem("authToken"),window.location.href="/auth/login"))}),m=new s.f({link:(0,o.D)([d,u,c]),cache:new a.h({typePolicies:{Query:{fields:{}}}}),defaultOptions:{watchQuery:{errorPolicy:"all"},query:{errorPolicy:"all"}}}),testApiConnectivity=async()=>{try{console.log("\uD83D\uDD0D Testing API connectivity...");let{GET_USER_ROLES:e}=await Promise.all([r.e(251),r.e(553)]).then(r.bind(r,1553)),t=await m.query({query:e,fetchPolicy:"network-only"});return console.log("✅ API connectivity test successful:",t.data),{success:!0,data:t.data}}catch(e){return console.error("❌ API connectivity test failed:",e),{success:!1,error:e}}}},6246:function(e,t,r){"use strict";r.d(t,{H:function(){return AuthProvider},a:function(){return useAuth}});var n=r(7573),s=r(9585);let o={user:null,token:null,loading:!0,isAuthenticated:!1},authReducer=(e,t)=>{switch(t.type){case"SET_LOADING":return{...e,loading:t.payload};case"SET_AUTH":return{...e,user:t.payload.user,token:t.payload.token,isAuthenticated:!0,loading:!1};case"CLEAR_AUTH":return{...e,user:null,token:null,isAuthenticated:!1,loading:!1};case"UPDATE_USER":return{...e,user:e.user?{...e.user,...t.payload}:null};default:return e}},a=(0,s.createContext)(null),useAuth=()=>{let e=(0,s.useContext)(a);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},AuthProvider=e=>{let{children:t}=e,[r,i]=(0,s.useReducer)(authReducer,o);return(0,s.useEffect)(()=>{let e=localStorage.getItem("authToken"),t=localStorage.getItem("userData");if(e&&t)try{let r=JSON.parse(t);i({type:"SET_AUTH",payload:{user:r,token:e}})}catch(e){console.error("Error parsing stored user data:",e),localStorage.removeItem("authToken"),localStorage.removeItem("userData"),i({type:"SET_LOADING",payload:!1})}else i({type:"SET_LOADING",payload:!1})},[]),(0,n.jsx)(a.Provider,{value:{state:r,dispatch:i},children:t})}},2851:function(e,t,r){"use strict";r.d(t,{J:function(){return NotificationProvider},l:function(){return useNotification}});var n=r(7573),s=r(9585),o=r(9155),a=r(8434);let i=(0,s.createContext)(null),useNotification=()=>{let e=(0,s.useContext)(i);if(!e)throw Error("useNotification must be used within a NotificationProvider");return e},NotificationProvider=e=>{let{children:t}=e,[r,l]=(0,s.useState)(!1),[c,u]=(0,s.useState)(""),[d,m]=(0,s.useState)("info"),handleClose=()=>{l(!1)};return(0,n.jsxs)(i.Provider,{value:{showNotification:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";u(e),m(t),l(!0)}},children:[t,(0,n.jsx)(o.Z,{open:r,autoHideDuration:6e3,onClose:handleClose,anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,n.jsx)(a.Z,{onClose:handleClose,severity:d,sx:{width:"100%"},children:c})})]})}},1553:function(e,t,r){"use strict";r.d(t,{GET_USER_ROLES:function(){return o},c7:function(){return a}});var n=r(8700),s=r(5448);function _templateObject(){let e=(0,n._)(["\n  query HealthCheck {\n    __schema {\n      queryType {\n        name\n      }\n    }\n  }\n"]);return _templateObject=function(){return e},e}function _templateObject1(){let e=(0,n._)(["\n  query GetUserRoles {\n    __schema {\n      queryType {\n        name\n      }\n    }\n  }\n"]);return _templateObject1=function(){return e},e}function _templateObject2(){let e=(0,n._)(["\n  query GetCurrentUser {\n    me {\n      id\n      email\n      firstName\n      lastName\n      role\n      profileComplete\n      createdAt\n    }\n  }\n"]);return _templateObject2=function(){return e},e}function _templateObject3(){let e=(0,n._)(["\n  mutation LoginUser($input: LoginInput!) {\n    login(input: $input) {\n      success\n      message\n      user {\n        id\n        email\n        firstName\n        lastName\n        role\n        profileComplete\n      }\n      token\n    }\n  }\n"]);return _templateObject3=function(){return e},e}function _templateObject4(){let e=(0,n._)(["\n  mutation RegisterUser($input: CreateUserInput!) {\n    register(input: $input) {\n      user {\n        id\n        email\n        displayName\n        roles\n        currentRole\n        profileComplete\n      }\n      token\n    }\n  }\n"]);return _templateObject4=function(){return e},e}(0,s.Ps)(_templateObject());let o=(0,s.Ps)(_templateObject1());(0,s.Ps)(_templateObject2()),(0,s.Ps)(_templateObject3());let a=(0,s.Ps)(_templateObject4())}},function(e){e.O(0,[424,993,292,471,251,456,293,53,744],function(){return e(e.s=2150)}),_N_E=e.O()}]);