@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* color-scheme will be set dynamically by theme provider */
    /* HospoGo surface: Deep Charcoal (#1A1A1A) */
    --background: 0 0% 10%;
    --foreground: 0 0% 98%;
    --card: 0 0% 12%;
    --card-foreground: 0 0% 98%;
    /* HospoGo brand */
    /* Slightly blue-shifted charcoal to better match the baked-in background of /brand-wordmark.png */
    --navbar: 214 23% 10%; /* #141A20 */
    --navbar-foreground: 0 0% 100%; /* #FFFFFF */
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 9%;
    /* Primary: Electric Lime (#32CD32) */
    --primary: 120 61% 50%;
    --primary-foreground: 0 0% 10%;
    /* Secondary: Deep Charcoal surfaces */
    --secondary: 0 0% 10%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 96%;
    --muted-foreground: 0 0% 45%;
    /* Accent: White (#FFFFFF) */
    --accent: 0 0% 100%;
    --accent-foreground: 0 0% 10%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 5.9% 90%;
    --input: 240 5.9% 90%;
    --ring: 120 61% 50%;
    --radius: 0.5rem;
    --error: 0 75% 45%;
    --error-foreground: 0 0% 100%;
    --success: 120 61% 50%;
    --success-foreground: 0 0% 100%;
    --warning: 45 100% 50%;
    --warning-foreground: 0 0% 100%;
    --info: 210 100% 45%;
    --info-foreground: 0 0% 100%;
  }

  .dark {
    color-scheme: dark;
    /* Keep dark mode aligned to the HospoGo surface */
    --background: 0 0% 10%;
    --foreground: 0 0% 98%;
    --card: 0 0% 12%;
    --card-foreground: 0 0% 98%;
    /* HospoGo brand in dark mode */
    /* Slightly blue-shifted charcoal to better match the baked-in background of /brand-wordmark.png */
    --navbar: 214 23% 10%; /* #141A20 */
    --navbar-foreground: 0 0% 100%; /* #FFFFFF */
    --popover: 0 0% 12%;
    --popover-foreground: 0 0% 98%;
    /* Primary: Electric Lime (#32CD32) */
    --primary: 120 61% 50%;
    --primary-foreground: 0 0% 10%;
    /* Secondary: Deep Charcoal surfaces */
    --secondary: 0 0% 10%;
    --secondary-foreground: 0 0% 98%;
    --muted: 240 3.7% 15.9%;
    --muted-foreground: 240 5% 64.9%;
    --accent: 240 3.7% 15.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 3.7% 15.9%;
    --input: 240 3.7% 15.9%;
    --ring: 120 61% 50%;
    --error: 0 75% 50%;
    --error-foreground: 0 0% 100%;
    --success: 120 61% 50%;
    --success-foreground: 0 0% 100%;
    --warning: 45 100% 60%;
    --warning-foreground: 0 0% 100%;
    --info: 210 100% 60%;
    --info-foreground: 0 0% 100%;
  }

  * {
    @apply border-border;
  }

  /* The Nuclear Option for Mobile Browsers - Force off-white in light mode */
  /* Samsung Internet Dark Mode Override Prevention */
  html {
    /* Tell browser to stop auto-adjusting colors */
    forced-color-adjust: none !important;
    -webkit-print-color-adjust: exact !important;
    
    overflow-x: hidden;
    width: 100%;
    position: relative;
  }

  /* Light mode specific styles for mobile */
  html.light, html:not(.dark) {
    color-scheme: light !important;
    /* The Gradient Trick: Samsung often skips inverting gradients */
    background-image: linear-gradient(hsl(var(--background)), hsl(var(--background))) !important;
    background-color: hsl(var(--background)) !important;
  }

  body {
    @apply bg-background text-foreground;
    color: hsl(var(--foreground)) !important;
    font-feature-settings: "rlig" 1, "calt" 1;
    /* Tell browser to stop auto-adjusting colors */
    forced-color-adjust: none !important;
    -webkit-print-color-adjust: exact !important;
    background-color: hsl(var(--background)) !important;
  }

  /* Light mode body background */
  html.light body, html:not(.dark) body {
    background-image: linear-gradient(hsl(var(--background)), hsl(var(--background))) !important;
  }

  /* Reset gradient trick for dark mode */
  html.dark {
    color-scheme: dark !important;
    background-image: none !important;
    background-color: hsl(var(--background)) !important;
  }

  html.dark body {
    background-image: none !important;
    background-color: hsl(var(--background)) !important;
  }

  #root {
    width: 100%;
    overflow-x: hidden;
  }

  /* Prevent horizontal overflow from common elements */
  img, video, iframe, svg {
    max-width: 100%;
    height: auto;
  }
}

@layer utilities {
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }
  .pt-safe {
    padding-top: env(safe-area-inset-top);
  }
  .min-h-safe {
    min-height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom));
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .neon-glow {
    text-shadow: 0 0 5px rgba(186, 255, 57, 0.8), 0 0 10px rgba(186, 255, 57, 0.5);
  }
  .logo-sharp {
    /* Deprecated: avoid image filters on logos (can look blurry on some displays). */
    image-rendering: auto;
  }
}

/* Immediate Touch Feedback */
button:active, a:active, [role="button"]:active {
  transform: scale(0.97);
  transition: transform 0.1s ease-in-out;
}

/* NProgress Customization */
#nprogress .bar {
  background: hsl(var(--primary));
  height: 3px;
}

#nprogress .peg {
  box-shadow: 0 0 10px hsl(var(--primary)), 0 0 5px hsl(var(--primary));
}

#nprogress .spinner-icon {
  border-top-color: hsl(var(--primary));
  border-left-color: hsl(var(--primary));
}

/* React Big Calendar Styles - High Contrast */
.rbc-calendar {
  font-family: inherit;
  background-color: hsl(var(--background));
  color: hsl(var(--foreground));
}

/* Header styling - Clean and transparent */
.rbc-header {
  padding: 0.5rem 0.25rem !important;
  font-weight: 600;
  border-bottom: 1px solid hsl(var(--border) / 0.5) !important;
  border-left: 1px solid hsl(var(--border) / 0.3) !important;
  text-align: center;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  background: transparent !important;
  color: hsl(var(--muted-foreground));
  font-size: 0.75rem;
  transition: all 0.2s ease;
}

.rbc-header:first-child {
  border-left: none !important;
}

/* Weekend header styling */
.rbc-header-weekend {
  border-bottom-color: hsl(var(--border) / 0.5) !important;
}

/* Dark mode header improvements */
.dark .rbc-header {
  background: transparent !important;
  border-bottom-color: hsl(var(--border) / 0.3) !important;
  border-left-color: hsl(var(--border) / 0.2) !important;
  color: hsl(var(--muted-foreground)) !important;
}

.dark .rbc-header-weekend {
  border-bottom-color: hsl(var(--border) / 0.3) !important;
}

.rbc-header-today {
  background: transparent !important;
  color: hsl(var(--foreground)) !important;
  font-weight: 700;
}

/* Dark mode today header - subtle highlight */
.dark .rbc-header-today {
  background: transparent !important;
  color: hsl(var(--foreground)) !important;
}

/* Time gutter with high contrast and subtle gradient */
.rbc-time-header-gutter {
  background: linear-gradient(to right, hsl(var(--muted)), hsl(var(--muted) / 0.95));
  border-right: 2px solid hsl(var(--border));
  color: hsl(var(--foreground));
  font-weight: 600;
}

.rbc-time-header-content {
  border-left: 2px solid hsl(var(--border));
  background-color: hsl(var(--background));
}

/* Week/Day view header z-index fix for mobile - ensures headers stay on top when scrolling */
.rbc-time-view .rbc-time-header {
  position: sticky;
  top: 0;
  z-index: 10;
  background-color: hsl(var(--background));
}

.rbc-time-header-gutter,
.rbc-time-header-content {
  position: relative;
  z-index: 11;
  background-color: hsl(var(--background));
}

/* Ensure header row stays on top of content */
.rbc-time-view .rbc-row {
  position: relative;
  z-index: 5;
}

/* Row containing day headers in week view */
.rbc-time-header-content .rbc-row {
  z-index: 11;
  background-color: hsl(var(--background));
}

/* Individual headers within the row */
.rbc-time-header-content .rbc-header {
  position: relative;
  z-index: 12;
  background-color: hsl(var(--background));
}

/* Dark mode time gutter - better contrast with gradient */
.dark .rbc-time-header-gutter {
  background: linear-gradient(to right, hsl(var(--muted) / 0.8), hsl(var(--muted) / 0.75)) !important;
  border-right-color: hsl(var(--border) / 0.9) !important;
  color: hsl(var(--foreground)) !important;
  font-weight: 700;
}

.dark .rbc-time-header-content {
  border-left-color: hsl(var(--border) / 0.9) !important;
}

/* Dark mode header z-index fix */
.dark .rbc-time-view .rbc-time-header {
  background-color: hsl(var(--background));
}

.dark .rbc-time-header-gutter,
.dark .rbc-time-header-content {
  background-color: hsl(var(--background));
}

.dark .rbc-time-header-content .rbc-row {
  background-color: hsl(var(--background));
}

.dark .rbc-time-header-content .rbc-header {
  background-color: hsl(var(--background));
}

/* Current day column styling in week/day view - Google Calendar style */
.rbc-time-view .rbc-day-slot.rbc-today {
  background-color: rgba(59, 130, 246, 0.08) !important; /* Subtle blue tint */
}

.rbc-time-view .rbc-day-slot.rbc-today .rbc-time-slot {
  border-top-color: hsl(var(--border));
}

.rbc-time-view .rbc-header.rbc-header-today + .rbc-day-bg {
  border-left: 3px solid hsl(var(--primary)) !important;
  background-color: rgba(59, 130, 246, 0.08) !important; /* Subtle blue tint */
}

.rbc-time-view .rbc-day-bg.rbc-today {
  background-color: rgba(59, 130, 246, 0.08) !important; /* Subtle blue tint */
}

/* Dark mode current day - more visible */
.dark .rbc-time-view .rbc-day-slot.rbc-today {
  background-color: rgba(59, 130, 246, 0.18) !important;
}

.dark .rbc-time-view .rbc-header.rbc-header-today + .rbc-day-bg {
  background-color: rgba(59, 130, 246, 0.18) !important;
}

.dark .rbc-time-view .rbc-day-bg.rbc-today {
  background-color: rgba(59, 130, 246, 0.18) !important;
}

/* Day background with clear borders */
.rbc-day-bg {
  border-color: hsl(var(--border));
  background-color: hsl(var(--background));
  transition: background-color 0.2s ease;
}

/* Weekend day backgrounds - subtle color tint */
.rbc-day-bg:nth-child(1),
.rbc-day-bg:nth-child(7) {
  background-color: rgba(168, 85, 247, 0.02);
}

.dark .rbc-day-bg:nth-child(1),
.dark .rbc-day-bg:nth-child(7) {
  background-color: rgba(168, 85, 247, 0.05) !important;
}

/* Dark mode day background - ensure visibility */
.dark .rbc-day-bg {
  border-color: #27272a !important; /* Subtle dark mode grid lines */
  background-color: hsl(var(--background)) !important;
}

.rbc-time-slot {
  border-top-color: hsl(var(--border) / 0.5);
}

/* Dark mode grid lines - subtle */
.dark .rbc-time-slot {
  border-top-color: #27272a !important;
}

.rbc-time-content {
  border-top-color: hsl(var(--border));
  background-color: hsl(var(--background));
}

.rbc-time-view {
  border-color: hsl(var(--border));
  background-color: hsl(var(--background));
}

.rbc-day-slot .rbc-time-slot {
  border-top-color: hsl(var(--border) / 0.5);
}

/* Today indicator with subtle transparent accent */
.rbc-today {
  background-color: rgba(59, 130, 246, 0.08) !important;
}

.rbc-today .rbc-day-bg {
  background-color: rgba(59, 130, 246, 0.08) !important;
  border-left: 3px solid hsl(var(--primary)) !important;
}

/* Dark mode today indicator - more visible */
.dark .rbc-today {
  background-color: rgba(59, 130, 246, 0.18) !important;
}

.dark .rbc-today .rbc-day-bg {
  background-color: rgba(59, 130, 246, 0.18) !important;
  border-left: 3px solid hsl(var(--primary)) !important;
}

/* Off-range days with subtle background */
.rbc-off-range-bg {
  background-color: hsl(var(--muted) / 0.4);
  color: hsl(var(--muted-foreground));
}

/* Events with high contrast and color coding */
.rbc-event {
  border-radius: 6px;
  padding: 8px 12px;
  border: 2px solid;
  font-weight: 500;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.rbc-event-content {
  font-size: 0.9375rem; /* 15px - slightly larger */
  font-weight: 600; /* Semi-bold */
  line-height: 1.5;
}

/* Event hover state */
.rbc-event:focus,
.rbc-event:active {
  outline: 2px solid hsl(var(--primary));
  outline-offset: 2px;
}

/* Month view cells */
.rbc-date-cell {
  color: hsl(var(--foreground));
  font-weight: 500;
  transition: color 0.2s ease;
}

.rbc-date-cell > a {
  color: hsl(var(--foreground));
  text-decoration: none;
  transition: all 0.2s ease;
}

.rbc-date-cell > a:hover {
  color: hsl(var(--primary));
  text-decoration: underline;
  transform: scale(1.05);
}

/* Weekend date cells - subtle color accent */
.rbc-date-cell:nth-child(1) > a,
.rbc-date-cell:nth-child(7) > a {
  color: rgba(168, 85, 247, 0.8);
}

.dark .rbc-date-cell:nth-child(1) > a,
.dark .rbc-date-cell:nth-child(7) > a {
  color: rgba(192, 132, 252, 0.9) !important;
}

/* Dark mode date cells - better contrast */
.dark .rbc-date-cell {
  color: hsl(var(--foreground)) !important;
  font-weight: 600;
}

.dark .rbc-date-cell > a {
  color: hsl(var(--foreground)) !important;
}

.dark .rbc-date-cell > a:hover {
  color: hsl(var(--primary)) !important;
}

/* Selected date styling */
.rbc-selected {
  background-color: hsl(var(--primary) / 0.2) !important;
  border: 2px solid hsl(var(--primary)) !important;
}

/* Hide default toolbar */
.rbc-toolbar {
  display: none !important;
}

.rbc-toolbar button {
  color: hsl(var(--foreground));
  border: 1px solid hsl(var(--border));
  background: hsl(var(--background));
}

.rbc-toolbar button:hover {
  background: hsl(var(--accent));
}

.rbc-toolbar button.rbc-active {
  background: hsl(var(--primary));
  color: hsl(var(--primary-foreground));
  border-color: hsl(var(--primary));
}

/* Calendar container with subtle gradient overlay */
.rbc-calendar {
  background: linear-gradient(135deg, hsl(var(--background)) 0%, hsl(var(--background)) 100%);
  position: relative;
}

.dark .rbc-calendar {
  background: linear-gradient(135deg, hsl(var(--background)) 0%, rgba(59, 130, 246, 0.02) 50%, rgba(168, 85, 247, 0.02) 100%);
}

/* Grid line improvements - lighter for better readability */
.rbc-month-view,
.rbc-time-view {
  border-color: hsl(var(--border) / 0.6);
}

.rbc-month-row {
  border-color: hsl(var(--border) / 0.6);
}

.rbc-day-bg + .rbc-day-bg {
  border-left-color: hsl(var(--border) / 0.6);
}

.rbc-row {
  border-color: hsl(var(--border) / 0.5);
}

.rbc-row-segment {
  border-color: hsl(var(--border) / 0.5);
}

/* Additional grid line styling for better visibility */
.rbc-time-content {
  border-left-color: hsl(var(--border) / 0.6);
}

.rbc-day-slot {
  border-right-color: hsl(var(--border) / 0.6);
}

/* Dark mode grid lines - subtle */
.dark .rbc-month-view,
.dark .rbc-time-view {
  border-color: #27272a !important;
}

.dark .rbc-month-row {
  border-color: #27272a !important;
}

.dark .rbc-day-bg + .rbc-day-bg {
  border-left-color: hsl(var(--border) / 0.8) !important;
}

.dark .rbc-row {
  border-color: hsl(var(--border) / 0.7) !important;
}

.dark .rbc-row-segment {
  border-color: hsl(var(--border) / 0.7) !important;
}

.dark .rbc-time-content {
  border-left-color: hsl(var(--border) / 0.8) !important;
}

.dark .rbc-day-slot {
  border-right-color: hsl(var(--border) / 0.8) !important;
}

.dark .rbc-time-slot {
  border-top-color: hsl(var(--border) / 0.7) !important;
}

.dark .rbc-day-slot .rbc-time-slot {
  border-top-color: hsl(var(--border) / 0.7) !important;
}

/* ======================================
   MONTH VIEW - CLEANER LAYOUT
   ====================================== */

/* Month view event rows - more compact */
.rbc-month-view .rbc-row-content {
  min-height: 80px;
}

.rbc-month-view .rbc-row-segment {
  padding: 1px 2px !important;
}

/* Month view events - cleaner, smaller padding */
.rbc-month-view .rbc-event {
  padding: 0 !important;
  border: none !important;
  border-radius: 4px !important;
  box-shadow: none !important;
  margin: 1px 0 !important;
  height: auto !important;
  min-height: 20px !important;
  max-height: 22px !important;
  overflow: hidden;
  pointer-events: auto !important;
  cursor: pointer !important;
}

/* Ensure shift blocks inside events are clickable */
.rbc-month-view .rbc-event .shift-block {
  pointer-events: auto !important;
  cursor: pointer !important;
}

/* Event wrapper should not block clicks */
.rbc-month-view .rbc-event-content {
  pointer-events: auto !important;
}

.rbc-month-view .rbc-event-content {
  font-size: 0.6875rem !important; /* 11px */
  font-weight: 500 !important;
  line-height: 1.3 !important;
  padding: 0 !important;
  height: 100% !important;
  display: flex !important;
  align-items: center !important;
}

/* Remove background from event wrapper - let ShiftBlock handle it */
.rbc-month-view .rbc-event {
  background: transparent !important;
}

/* Show more link - cleaner styling */
.rbc-month-view .rbc-show-more {
  font-size: 0.6875rem !important;
  font-weight: 600 !important;
  color: hsl(var(--primary)) !important;
  background: transparent !important;
  padding: 2px 4px !important;
  margin-top: 2px !important;
  text-decoration: none !important;
  display: inline-block !important;
  transition: color 0.2s ease !important;
}

.rbc-month-view .rbc-show-more:hover {
  color: hsl(var(--primary) / 0.8) !important;
  text-decoration: underline !important;
}

.dark .rbc-month-view .rbc-show-more {
  color: hsl(220 90% 70%) !important;
}

.dark .rbc-month-view .rbc-show-more:hover {
  color: hsl(220 90% 80%) !important;
}

/* Month row borders - subtle */
.rbc-month-view .rbc-month-row + .rbc-month-row {
  border-top: 1px solid hsl(var(--border) / 0.4) !important;
}

/* Date cell in month view - cleaner */
.rbc-month-view .rbc-date-cell {
  padding: 4px 6px !important;
  font-size: 0.8125rem !important;
  font-weight: 500 !important;
}

.rbc-month-view .rbc-date-cell.rbc-now {
  font-weight: 700 !important;
}

.rbc-month-view .rbc-date-cell.rbc-now > a {
  background: hsl(var(--primary)) !important;
  color: hsl(var(--primary-foreground)) !important;
  border-radius: 50% !important;
  width: 24px !important;
  height: 24px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
}

.dark .rbc-month-view .rbc-date-cell.rbc-now > a {
  background: hsl(220 80% 60%) !important;
  color: white !important;
}

/* Off-range date cells - subtle */
.rbc-month-view .rbc-off-range {
  color: hsl(var(--muted-foreground) / 0.5) !important;
}

.rbc-month-view .rbc-off-range-bg {
  background-color: hsl(var(--muted) / 0.2) !important;
}

.dark .rbc-month-view .rbc-off-range-bg {
  background-color: hsl(var(--muted) / 0.1) !important;
}

/* Overlay popup for "+X more" - cleaner */
.rbc-overlay {
  background: hsl(var(--card)) !important;
  border: 1px solid hsl(var(--border)) !important;
  border-radius: 8px !important;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15) !important;
  padding: 8px !important;
  max-width: 280px !important;
  z-index: 1000 !important;
}

.dark .rbc-overlay {
  background: hsl(var(--card)) !important;
  border-color: hsl(var(--border)) !important;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4) !important;
}

.rbc-overlay-header {
  font-size: 0.8125rem !important;
  font-weight: 600 !important;
  color: hsl(var(--foreground)) !important;
  padding-bottom: 6px !important;
  margin-bottom: 6px !important;
  border-bottom: 1px solid hsl(var(--border) / 0.5) !important;
}

.rbc-overlay > * + * {
  margin-top: 4px !important;
}

/* Shift block styles in month view */
.rbc-month-view .shift-block {
  border-radius: 4px !important;
  height: 100% !important;
}

/* Remove focus outline flash */
.rbc-month-view .rbc-event:focus {
  outline: none !important;
}

.rbc-month-view .rbc-event.rbc-selected {
  box-shadow: 0 0 0 2px hsl(var(--primary) / 0.5) !important;
}

/* ======================================
   WEEK/DAY VIEW - SLIGHTLY CLEANER
   ====================================== */

.rbc-time-view .rbc-event {
  border-radius: 4px !important;
  border: none !important;
  padding: 2px 6px !important;
}

.rbc-time-view .rbc-event-label {
  font-size: 0.6875rem !important;
  font-weight: 500 !important;
  opacity: 0.9;
}