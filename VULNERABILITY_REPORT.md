# Dependency Vulnerability Report
**Generated:** January 17, 2026  
**Repository:** SgtClickClack/snipshift  
**Status:** ⚠️ Discrepancy Detected

## Summary

- **GitHub Dependabot:** 24 vulnerabilities detected (11 high, 7 moderate, 6 low)
- **npm audit:** 0 vulnerabilities detected
- **Status:** Investigation Required

## Discrepancy Analysis

The discrepancy between GitHub Dependabot and npm audit can occur due to:

1. **Different Vulnerability Databases**
   - GitHub uses the GitHub Advisory Database (GHSA)
   - npm uses the npm Security Advisory Database
   - These databases are updated at different rates and may contain different entries

2. **Transitive Dependencies**
   - GitHub may flag vulnerabilities in nested dependencies that npm audit doesn't catch
   - Some vulnerabilities may be in dev dependencies or optional dependencies

3. **Database Update Timing**
   - One database may have been updated more recently than the other

## How to View GitHub Dependabot Report

To view the actual vulnerabilities reported by GitHub:

1. **Via GitHub Web Interface:**
   - Navigate to: `https://github.com/SgtClickClack/snipshift/security/dependabot`
   - Or: Repository → Security tab → Dependabot alerts

2. **Via GitHub CLI (if authenticated):**
   ```bash
   gh api repos/SgtClickClack/snipshift/dependabot/alerts
   ```

3. **Via GitHub API:**
   ```bash
   curl -H "Authorization: token YOUR_TOKEN" \
     https://api.github.com/repos/SgtClickClack/snipshift/dependabot/alerts
   ```

## Potential Vulnerable Dependencies

Based on the package.json, here are packages that commonly have vulnerabilities:

### High Priority (Commonly Vulnerable)

1. **moment** (`^2.30.1`)
   - **Status:** Deprecated library
   - **Risk:** Known vulnerabilities in date parsing and locale handling
   - **Recommendation:** Already using `date-fns` (`^4.1.0`) - consider removing `moment` if not needed
   - **Action:** Audit usage and migrate remaining `moment` calls to `date-fns`

2. **express** (`^4.22.1`)
   - **Status:** Check for latest security patches
   - **Risk:** Potential security issues in older versions
   - **Recommendation:** Ensure using latest 4.x patch version
   - **Action:** Run `npm update express` to get latest patches

3. **firebase** (`^12.8.0`) & **firebase-admin** (`^13.6.0`)
   - **Status:** Check for known CVEs
   - **Risk:** Authentication and data access vulnerabilities
   - **Recommendation:** Update to latest versions if patches available
   - **Action:** Check Firebase security advisories

4. **pg** (`^8.17.1`) - PostgreSQL client
   - **Status:** Check for SQL injection vulnerabilities
   - **Risk:** Database access issues
   - **Recommendation:** Ensure using parameterized queries (likely already done with Drizzle ORM)
   - **Action:** Review database query patterns

### Medium Priority

5. **axios** (via override: `^1.8.2`)
   - **Status:** Check for CSRF and SSRF vulnerabilities
   - **Risk:** Request handling issues
   - **Recommendation:** Ensure using latest 1.x version
   - **Action:** Verify override is using secure version

6. **react-big-calendar** (`^1.19.4`)
   - **Status:** Check for XSS vulnerabilities
   - **Risk:** React component vulnerabilities
   - **Recommendation:** Update if patches available

7. **recharts** (`^3.6.0`)
   - **Status:** Check for vulnerabilities in chart rendering
   - **Risk:** Data visualization security issues
   - **Recommendation:** Update to latest version

### Low Priority (But Should Review)

8. **@radix-ui/** packages (multiple)
   - **Status:** Generally well-maintained
   - **Risk:** Low, but check for component-specific issues
   - **Recommendation:** Update to latest versions if available

9. **drizzle-orm** (`^0.45.1`)
   - **Status:** Check for SQL injection patterns
   - **Risk:** ORM-level vulnerabilities
   - **Recommendation:** Ensure using latest version

10. **cors** (`^2.8.5`)
    - **Status:** Check CORS configuration
    - **Risk:** Misconfiguration can expose APIs
    - **Recommendation:** Review CORS settings in API

## Recommended Actions

### Immediate (High Priority)

1. **View GitHub Dependabot Report**
   ```bash
   # Visit: https://github.com/SgtClickClack/snipshift/security/dependabot
   ```

2. **Review and Prioritize**
   - Focus on High severity vulnerabilities first
   - Review Moderate severity for critical paths
   - Address Low severity as time permits

3. **Update Critical Dependencies**
   ```bash
   npm update express firebase firebase-admin
   ```

### Short-term (This Week)

4. **Remove or Replace Deprecated Packages**
   - Audit `moment` usage
   - Migrate remaining usage to `date-fns`
   - Remove `moment` if no longer needed

5. **Review Overrides**
   - Check if `axios` override is necessary
   - Verify override versions are secure

6. **Run Alternative Scanners**
   ```bash
   # Install Snyk (if available)
   npm install -g snyk
   snyk test
   
   # Or use OWASP Dependency-Check
   ```

### Long-term (This Month)

7. **Set Up Automated Scanning**
   - Configure Dependabot to auto-create PRs for security updates
   - Add security checks to CI/CD pipeline
   - Set up weekly dependency review process

8. **Create Security Policy**
   - Document vulnerability response process
   - Set CVSS thresholds for blocking releases
   - Establish update cadence

## Package Overrides Review

Current overrides in package.json:
```json
"overrides": {
  "diff": "^8.0.3",
  "node-forge": "^1.3.3",
  "qs": "^6.14.1",
  "jws": "^4.0.1",
  "axios": "^1.8.2"
}
```

**Action Required:** Review each override to ensure:
- Override is necessary (not just masking a vulnerability)
- Override version is secure
- Override doesn't introduce new vulnerabilities

## Next Steps

1. ✅ **View GitHub Dependabot Report** - Get exact list of 24 vulnerabilities
2. ⏳ **Prioritize by Severity** - Focus on High (11) first
3. ⏳ **Create Update Plan** - Schedule dependency updates
4. ⏳ **Test Updates** - Ensure updates don't break functionality
5. ⏳ **Document Changes** - Track what was updated and why

## Resources

- [GitHub Dependabot Documentation](https://docs.github.com/en/code-security/dependabot)
- [npm Security Best Practices](https://docs.npmjs.com/security-best-practices)
- [Snyk Vulnerability Database](https://security.snyk.io/)
- [National Vulnerability Database](https://nvd.nist.gov/)

---

**Note:** This report is based on package.json analysis and common vulnerability patterns. The actual vulnerabilities are listed in GitHub Dependabot. Please review the GitHub Security tab for the definitive list.
